<!DOCTYPE>
<html>
<head>
	<link href="../static/crikit.css" rel="stylesheet">
</head>

<body >
	<!-- test line -->
	<div id="test_box"> </div>
	
	<div id="start_chirp_div">
		<br><br><br><br><br><br>
		<form action="/chirp">
			<input type="radio" class ="choice" name="user_choice" value="use_user_location"> Get temperature for my location
			<br><br>
			<input type="radio" class ="choice" name="user_choice" value="use_user_temp">
			<input type="text" name="user_temp" id="temp_input"> Use this temperature
			<br><br>
			<input type="submit" id="start_chirping_button" value="Chirp">
		</form>
	</div>

	<div id="stop_chirp_div">
		<br><br><br><br><br><br><br><br><br><br>
		<form action="/crikit">
			<input type="submit" id="stop_chirping_button" value="Stop Chirping">
		</form>
		
		<!-- test lines -->
		<!-- <p>{{ chirp_time }} between each chirp</p> -->
	</div>

	<ul>
		{% for message in get_flashed_messages() %}
			<li> {{ message }} </li>
		{% endfor %}
	</ul>

</body>
<script src="https://code.jquery.com/jquery.js"> </script>
<!-- <script src="/static/crickit.js"></script> -->


<script>
// assigns variables to elements
var start_chirp = document.getElementById("start_chirp_div");
var stop_chirp = document.getElementById("stop_chirp_div");
var stop_button = document.getElementById("stop_chirping_button");
var start_button = document.getElementById("start_chirping_button");

// sets initial state for site
$(start_chirp).show();
$(stop_chirp).hide();


function changeChirp(evt) { 
	//doesn't submit form, hides stop and shows start. 

	// test:
	console.log("changeChirp() runs");

	// don't submit form
	evt.preventDefault();

	// toggle which div shows on site
	$(start_chirp).toggle();
	$(stop_chirp).toggle();
};


function startChirping(evt) {
	//Passes user input to .py, calls makeChirp on results
	
	changeChirp(evt);

	// test:
	console.log("re-enters startChirping");

	// Sets path to chirp with variables from html form
	var url = "/chirp?" + $("form").serialize();

	// test: prints out url to console
	console.log("user info url: " + url);

	// SHOULD pass url to server, then call makeChirps() on resulting info. Doesn't recognize data.
	// $.get(url, makeChirps(data));
	// Using an anonymous function that calls makeChirp works. Hm.
	$.get(url, function (results) {
		makeChirps(results);
	});

};


function makeChirps(chirp_time) {
	// Takes in a time between chirps, and chirps at that interval. Returns nothing.

	// test: 
	console.log("got into chirp_time");
	console.log(chirp_time);
};


function stopChirping(evt) { 
	// stop chirping and return to start page.

	changeChirp(evt);

	// Will need to stop chirping, too.

};

// Calls appropriate function for button clicks.
$("#start_chirping_button").on('click', startChirping);
$("#stop_chirping_button").on('click', stopChirping);

</script>

</html>